{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="keywords"
          content="environmental compliance, management system, greenova, sustainability" />
    <meta name="description" content="
      {% block meta_description %}Environmental Compliance Management System{% endblock meta_description %}
 " />
      <title>

        {% block title %}

          {% block page_title %}
Greenova
          {% endblock page_title %}
        {% endblock title %}

      </title>
      <!-- Critical CSS -->
      <link rel="preload" href="{% static 'css/vendor/modern-normalize.css' %}" as="style" />
      <link rel="preload" href="{% static 'css/vendor/pico.classless.min.css' %}" as="style" />
      <!-- CSS files -->
      <link rel="stylesheet" href="{% static 'css/vendor/modern-normalize.css' %}" />
      <link rel="stylesheet" href="{% static 'css/vendor/pico.classless.min.css' %}" />
      <style>
          .nav-menu {
              display: flex;
              width: 100%;
              align-items: center;
          }

          .nav-item {
              margin-left: 2rem;
          }

          .nav-item-auto {
              margin-left: auto;
              display: flex;
              align-items: center;
              gap: 1rem;
          }
      </style>

      {% block extra_head %}
      {% endblock extra_head %}

    </head>
    <body>
      <header>
        <nav>
          <ul role="menubar" aria-label="Primary navigation" class="nav-menu">
            {% if request.user.is_authenticated %}
              <!-- Left side navigation items -->
              <li class="nav-item">
                <a href="{% url 'dashboard:home' %}">Dashboard</a>
              </li>
              <li class="nav-item">
                <a href="{% url 'projects:select' %}">Projects</a>
              </li>
              <!-- Right side items -->
              <li class="nav-item-auto">
                <span>{{ request.user.get_full_name|default:request.user.username }}</span>
                <form method="post" action="{% url 'authentication:logout' %}">
{% csrf_token %}
                  <button type="submit">
Logout
                  </button>
                </form>
              </li>
            {% else %}
              <li class="nav-item-auto">
                <a href="{% url 'authentication:login' %}" role="button">Login</a>
                <a href="{% url 'authentication:register' %}" role="button" class="outline">Register</a>
              </li>
            {% endif %}
          </ul>
        </nav>
      </header>

      <!-- Main content -->
      <main role="main">

        {% block main %}
        {% endblock main %}

      </main>

      <!-- Footer -->

      {% block footer %}
        <footer role="contentinfo">
          <p>
          System Status:
            <mark>{{ system_status }}</mark> |
          Version: {{ app_version }} |
          Last Updated: {{ last_updated|date:"j M Y" }}
          </p>
          <p>
          Â© {% now "Y" %} <a href="https://www.enveng-group.com.au/" target="_blank" rel="noopener noreferrer">Enveng Group</a> |
                              Licensed under <a href="https://www.gnu.org/licenses/agpl-3.0.html"
    target="_blank"
    rel="noopener noreferrer">GNU AGPL v3.0</a>
        </p>
      </footer>
    {% endblock footer %}

    <!-- Scripts -->
    <script src="{% static 'js/vendor/htmx.min.js' %}" defer></script>
    <script src="{% static 'js/vendor/_hyperscript.min.js' %}" defer></script>
    <script src="{% static 'js/vendor/chart.umd.js' %}" defer></script>
    <script src="{% static 'js/app.js' %}" type="module" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Chart.js loaded:', typeof Chart !== 'undefined');
            console.log('HTMX loaded:', typeof htmx !== 'undefined');
        });
    </script>
  </body>
</html>
